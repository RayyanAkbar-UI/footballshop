{% extends 'base.html' %}

{% block content %}
<div class="container mx-auto mt-10 p-4">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold mb-6 neural-glow">Edit Product: {{ product.name }}</h1>
        
        <div class="glass rounded-xl p-6">
            <form method="POST" class="space-y-6" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Loop untuk field Name, Price, dan Description -->
                {% for field in form %}
                    {% if field.name != 'category' %}
                    <div>
                        <label for="{{ field.id_for_label }}" class="block text-sm uppercase opacity-70 mb-1">{{ field.label }}</label>
                        {{ field }}
                        {% if field.errors %}
                            {% for error in field.errors %}
                            <p class="text-red-400 text-xs mt-1">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>
                    {% endif %}
                {% endfor %}
                
                <div>
                    <label class="block text-sm uppercase opacity-70 mb-1">Category</label>
                    <div x-data="{ open: false, selectedLabel: '{{ product.get_category_display|default:'Select a Category' }}' }">
                        <input type="hidden" name="category" id="id_category_value" value="{{ product.category }}">
                        <div class="relative mt-1">
                            <button @click="open = !open" type="button" class="glass-button relative w-full cursor-default rounded-md py-2 pl-3 pr-10 text-left shadow-sm sm:text-sm">
                                <span class="block truncate" x-text="selectedLabel"></span>
                                <span class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2">
                                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.53.22l3.5 3.5a.75.75 0 01-1.06 1.06L10 4.81 6.53 8.28a.75.75 0 01-1.06-1.06l3.5-3.5A.75.75 0 0110 3zm-3.72 9.28a.75.75 0 011.06 0L10 15.19l3.47-3.47a.75.75 0 111.06 1.06l-4 4a.75.75 0 01-1.06 0l-4-4a.75.75 0 010-1.06z" clip-rule="evenodd" /></svg>
                                </span>
                            </button>
                            <ul x-show="open" @click.away="open = false" x-transition class="absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md glass shadow-lg ring-1 ring-white/20 focus:outline-none sm:text-sm">
                                {% for value, label in form.fields.category.choices %}
                                    {% if value %}
                                    <li @click="selectedLabel = '{{ label }}'; document.getElementById('id_category_value').value = '{{ value }}'; open = false;" 
                                        class="text-gray-300 hover:bg-white/10 hover:text-white relative cursor-default select-none py-2 pl-3 pr-9">
                                        <span class="font-normal block truncate">{{ label }}</span>
                                    </li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="pt-4">
                    <button type="submit" class="action-link w-full bg-purple-900/20 hover:bg-purple-900/30 py-3">
                        <span class="mr-2">ðŸ’¾</span>
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}